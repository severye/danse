<script>
    $('selectpicker').selectpicker('refresh');
</script>
<mat-dialog-content>
    <div>
        <span>Nom : </span>
        <span><input type="text" name="name" [(ngModel)]="product.name" required #uname="ngModel" />
            <span *ngIf="uname.invalid"> 
                Name required. 
            </span> </span>
    </div>      
    <div>
        <span>Image : </span>
        <span>
            <image-upload [max]="2" (removed)="onRemoved($event)" (uploadStateChanged)="onUploadStateChanged($event)" (uploadFinished)="onUploadFinished($event)" url="http://localhost:8080/images" buttonCaption="Selectionner une image" clearButtonCaption="supprimer" [uploadedFiles]="path"></image-upload>
        </span>
    </div>
    <div>
        <span>Commentaire : </span>
        <span><textarea class="wTotal" name="comment" [(ngModel)]="product.comment" ></textarea></span>
    </div>
    <div class="left">
        <span>Quantité : </span>
        <span><input type="number" name="totalQuantity" [(ngModel)]="product.totalQuantity" (ngModelChange)="changeQuantity()"/></span>
    </div> 
    <div class="left">
        <span class="left">Détail des quantités : </span>
        <span class="left">
            
            <span *ngIf="product.sizeQuantities">
                
                <span *ngFor="let sizeQuantity of product.sizeQuantities">
                    <select [(ngModel)]="sizeQuantity.idSize"  class="selectpicker size" disabled >
                        <option *ngFor="let size of sizes" [ngValue]="size.id" >{{size.name}}</option>
                    </select>
                    <input type="number" name="quantity" [(ngModel)]="sizeQuantity.quantity" (ngModelChange)="changeQuantity()"/>  
                </span>
            </span>
            <span>
                <select [(ngModel)]="newSizeQuantity.idSize"  class="selectpicker size" [disabled]="allSizesAttributed">
                    <option *ngFor="let size of sizesNotAttributed" [ngValue]="size.id" >{{size.name}}</option>
                </select>
                <input type="number" name="quantity" [(ngModel)]="newSizeQuantity.quantity" [disabled]="allSizesAttributed" (ngModelChange)="changeQuantity()"/>    
            </span> 
        </span>
        
    </div> 
    <div class="left" *ngIf="sizesNotAttributed.length>1" ><button [disabled]="newSizeQuantity.idSize==null" (click)="addRow()" class="btn btn-primary">Ajouter une autre taille</button></div>
    <div class="clear"></div>
    
    <div *ngIf="unequalQuantity" class="alert alert-warning">Les quantités ne correspondent pas à la quantité générale</div>      
    <div *ngIf="allSizesAttributed">Toutes les tailles possibles ont déjà été attribuées<br>

    </div>
    
    <div class="left">
        <span>Color : </span>
        <span>
            <select  [(ngModel)]="product.colour.id" class="selectpicker">
                <option *ngFor="let color of colors" [ngValue]="color.id" [ngStyle]="{'background-color':color.colorCode}">{{color.name}}</option>
            </select>      
        </span>
    </div>
    <div class="left">
        <span>Modèle : </span>
        <span><select  [(ngModel)]="product.type.id" class="selectpicker">
                <option *ngFor="let type of types" [ngValue]="type.id">{{type.name}}</option>
                </select>   
        </span>
    </div>
    <div class="left">
        <span>Genre : </span>
        <span><select  [(ngModel)]="product.kind.id" class="selectpicker">
                <option *ngFor="let kind of kinds" [ngValue]="kind.id">{{kind.name}}</option>
                </select>   
        </span>
    </div>
    <div class="left">
        <span>Categorie : </span>
        <span><select  [(ngModel)]="product.category.id" class="selectpicker">
                <option *ngFor="let category of categories" [ngValue]="category.id">{{category.name}}</option>
                </select>   
        </span>
    </div>
    <div class="left">
        <span>Malle : </span>
        <span><select  [(ngModel)]="product.box.id" class="selectpicker">
                <option *ngFor="let box of boxes" [ngValue]="box.id">{{box.name}}</option>
                </select>   
        </span>
    </div>
</mat-dialog-content>

<mat-dialog-actions class="wTotal">
        <div class="col-xs-5 left"><button mat-dialog-close class="btn btn-small btn-light " (click)="close()">Fermer</button></div>
        <div class="col-xs-6 right"><button [disabled]="" class="btn btn-success btn-small right"(click)="save()" [disabled]="!show || (product.name==null)" id="validate">Valider</button></div>
</mat-dialog-actions>